(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[827],{8452:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/basket/checkout",function(){return c(6293)}])},3771:function(e,t,c){"use strict";function n(e){return{type:"SET_PRODUCT_TO_BASKET",item:e}}function r(e,t){return{type:"EDIT_PRODUCT_COUNT",id:e,qty:t}}function a(e){return{type:"DELETE_PRODUCT",id:e}}function s(){return{type:"RESET_PRODUCT"}}c.d(t,{Ir:function(){return a},gn:function(){return n},k:function(){return r},ms:function(){return s}})},8610:function(e,t,c){"use strict";var n=c(5893),r=c(7294);let a=e=>{let{classes:t="",children:c,...a}=e,s=r.Children.map(c,e=>r.isValidElement(e)?r.cloneElement(e,{...a}):e);return(0,n.jsx)("div",{className:t,children:s})};t.Z=a},5499:function(e,t,c){"use strict";var n=c(5893),r=c(7294);let a=e=>{let{setDataForm:t,dataForm:c,nameForm:a,errorForm:s,children:l,onChanges:u,...i}=e,{name:o,required:d,...m}=i,[h,f]=(0,r.useState)(!1),_=s[o],p=s[o]?" form-input__error":"",x=a+"-"+o,k=(0,r.useRef)(null),j=()=>{let e=c;e[k.current.name]={type:k.current.type,name:k.current.name,value:k.current.value,required:k.current.required},t(e)},y=()=>{let e=c;delete e[o],t(e)},v=e=>{let n=c;n[e.target.name]={type:e.target.type,name:e.target.name,value:e.target.value,required:e.target.required},t(e=>({...e,...n})),u&&u(e),f(!!e.target.value.length)},g=()=>{if(_){let e=_.customText?_.customText:"Заполните поле";return(0,n.jsx)("span",{className:"form-input__error-text",children:e})}};return(0,r.useEffect)(()=>(j(),()=>{y()}),[]),(0,n.jsxs)("div",{className:"form-input",children:[(0,n.jsx)("textarea",{className:(h?"focused":"")+p,name:o,id:x,required:d,onChange:v,ref:k,...m}),l&&(0,n.jsxs)("label",{htmlFor:x,children:[l,d&&" *"]}),(0,n.jsx)(g,{})]})};t.Z=a},6293:function(e,t,c){"use strict";c.r(t),c.d(t,{default:function(){return p}});var n=c(5893),r=c(7294),a=c(9473),s=c(3771),l=c(9839),u=c(8610),i=c(6331),o=c(5499);let d=e=>{let{num:t,setDataForm:c,dataForm:a,nameForm:s,errorForm:l,children:u,onChanges:i,...o}=e,{name:d,required:m,...h}=o,f=l[d],_=l[d]?" form-input__error":"";t=t?"-"+t:"";let p=s+"-"+d+t,x=(0,r.useRef)(null),k=()=>{let e=a;x.current.checked&&(e[x.current.name]={type:x.current.type,name:x.current.name,value:x.current.defaultValue},c(e))},j=()=>{let e=a;delete e[d],c(e)},y=e=>{let t=a;t[e.target.name]={type:e.target.type,name:e.target.name,value:e.target.value},c(e=>({...e,...t})),i&&i(e)},v=()=>{if(f){let e=f.customText?f.customText:"Заполните поле";return(0,n.jsx)("span",{className:"form-input__error-text",children:e})}};return(0,r.useEffect)(()=>(k(),()=>{j()}),[]),(0,n.jsxs)("div",{className:"form-radio",children:[(0,n.jsx)("input",{type:"radio",className:_,name:d,id:p,required:m,onChange:y,ref:x,...h}),u&&(0,n.jsxs)("label",{htmlFor:p,children:[u,m&&" *"]}),(0,n.jsx)(v,{})]})},m=e=>{let{num:t,setDataForm:c,dataForm:a,nameForm:s,errorForm:l,children:u,onChanges:i,...o}=e,{name:d,required:m,...h}=o,f=l[d],_=l[d]?" form-input__error":"";t=t?"-"+t:"";let p=s+"-"+d+t,x=(0,r.useRef)(null),k=()=>{let e=a;x.current.checked&&(e[x.current.name]={type:x.current.type,name:x.current.name,value:x.current.defaultValue,required:x.current.required,checked:x.current.checked},c(e))},j=()=>{let e=a;delete e[d],c(e)},y=e=>{let t=a;t[e.target.name]={type:e.target.type,name:e.target.name,value:e.target.value,required:e.target.required,checked:e.target.checked},c(e=>({...e,...t})),i&&i(e)},v=()=>{if(f){let e=f.customText?f.customText:"Заполните поле";return(0,n.jsx)("span",{className:"form-input__error-text",children:e})}};return(0,r.useEffect)(()=>(k(),()=>{j()}),[]),(0,n.jsxs)("div",{className:"form-checkbox",children:[(0,n.jsx)("input",{type:"checkbox",className:_,name:d,id:p,required:m,onChange:y,ref:x,...h}),u&&(0,n.jsxs)("label",{htmlFor:p,children:[u,m&&" *"]}),(0,n.jsx)(v,{})]})};var h=c(9008),f=c.n(h);let _=()=>{let e=(0,a.I0)(),t=(0,a.v9)(e=>e.basket.items),c=(0,a.v9)(e=>e.users.users),h=(0,a.v9)(e=>e.authentication.id),_=h?c.find(e=>e.id===h):{},[p,x]=(0,r.useState)(!1),[k,j]=(0,r.useState)(!1),[y,v]=(0,r.useState)([]),g=t.reduce((e,t)=>e+t.price*t.qty,0),b=async e=>{v([]);let t=await Promise.all(e.map(async e=>{try{let t="https://punkapi.online/v3/beers/".concat(e.id),c=await fetch(t),n=await c.json(),r={id:n.id,name:n.name,price:n.ibu,image:n.image,qty:e.qty};return r}catch(a){console.log(a)}}));v(t)},N=()=>y.map(e=>"- Название: ".concat(e.name,"; Цена: ").concat(e.price,"$; Количество: ").concat(e.qty," шт.; Сумма: ").concat(e.price*e.qty,"$ \n")).join(""),q=t=>{e((0,s.ms)());let c=t.type_client?"Тип клиента: ".concat(t.type_client):"",n=t.name?"ФИО: ".concat(t.name):"",r=t.phone?"Телефон: ".concat(t.phone):"",a=t.email?"Email: ".concat(t.email):"",l=t.type_payment?"Способ оплаты: ".concat(t.type_payment):"",u=t.type_delivery?"Способ доставки: ".concat(t.type_delivery):"",i=t.delivery_address?"Адрес доставки: ".concat(t.delivery_address):"",o=y?"Список товаров:\n\n".concat(N()):"",d='\nПредставим что это пришло на почту\n\nФорма "Оформление заказа"\n'.concat(c,"\n").concat(n,"\n").concat(r,"\n").concat(a,"\n").concat(l,"\n").concat(u,"\n").concat(i,"\n-----------\n").concat(o,"\n").concat("Общая сумма: ".concat(g,"$"),"\n        ");console.log(d),j(!0)},E=()=>(0,n.jsxs)("div",{className:"form-success form-success--checkout",children:[(0,n.jsx)("div",{className:"form-success__title",children:"Спасибо за покупку"}),(0,n.jsx)("div",{className:"form-success__text",children:"Мы свяжемся с вами в ближайшее время."}),(0,n.jsx)("div",{className:"form-success__text",children:"(результат в консоле)"})]});return(0,r.useEffect)(()=>{b(t)},[t.length]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(f(),{children:[(0,n.jsx)("title",{children:"Оформление заказа | Черное красное - магазин пива"}),(0,n.jsx)("meta",{name:"description",content:"Черное красное - магазин пива"}),(0,n.jsx)("link",{rel:"icon",href:"".concat("/React-Shop","/favicon.ico")})]}),(0,n.jsx)("h1",{className:"page-title",children:"Оформление заказа"}),(()=>{if(!t.length&&!k)return(0,n.jsx)("p",{children:"Корзина пуста"});{let e=h?_.name:"",c=h?_.phone:"",r=h?_.email:"";return(0,n.jsx)("div",{className:"checkout",children:(0,n.jsxs)(l.Z,{nameForm:"checkout",successText:E,sendMessage:q,textBtn:"Оформить заказ",children:[(0,n.jsxs)(u.Z,{classes:"checkout-form__block",children:[(0,n.jsx)(u.Z,{classes:"checkout-form__block-title",children:"Тип покупателя"}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block-radio",children:[(0,n.jsx)(d,{num:1,name:"type_client",value:"Физическое лицо",defaultChecked:!0,children:"Физическое лицо"}),(0,n.jsx)(d,{num:2,name:"type_client",value:"Юридическое лицо",children:"Юридическое лицо"})]})]}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block",children:[(0,n.jsx)(u.Z,{classes:"checkout-form__block-title",children:"Способ доставки"}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block-radio",children:[(0,n.jsx)(d,{num:1,name:"type_delivery",value:"Самовывоз",defaultChecked:!0,onChanges:()=>x(!1),children:"Самовывоз"}),(0,n.jsx)(d,{num:2,name:"type_delivery",value:"Доставка курьером",onChanges:()=>x(!0),children:"Доставка курьером"})]}),p&&(0,n.jsx)(o.Z,{name:"delivery_address",required:!0,rows:4,children:"Адрес доставки"})]}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block",children:[(0,n.jsx)(u.Z,{classes:"checkout-form__block-title",children:"Способ оплаты"}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block-radio",children:[(0,n.jsx)(d,{num:1,name:"type_payment",value:"Наличный расчет",defaultChecked:!0,children:"Наличный расчет"}),(0,n.jsx)(d,{num:2,name:"type_payment",value:"Безналичный расчет",children:"Безналичный расчет"})]})]}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block",children:[(0,n.jsx)(u.Z,{classes:"checkout-form__block-title",children:"Данные покупателя"}),(0,n.jsx)(i.Z,{name:"name",defaultValue:e,children:"Ваше ФИО"}),(0,n.jsx)(i.Z,{type:"phone",name:"phone",mask:"+7 (999) 999-99-99",required:!0,defaultValue:c,children:"Ваш телефон"}),(0,n.jsx)(i.Z,{type:"email",name:"email",required:!0,defaultValue:r,children:"Ваш e-mail"})]}),(0,n.jsxs)(u.Z,{classes:"checkout-form__block checkout-form__block--total",children:["Итого: ",g,"$"]}),(0,n.jsx)(u.Z,{classes:"checkout-form__block checkout-form__block--policy",children:(0,n.jsx)(m,{name:"policy",value:"Согласие",defaultChecked:!0,required:!0,children:"Подтвердите согласие на обработку персональных данных"})})]})})}})()]})};var p=_},9008:function(e,t,c){e.exports=c(3121)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8452)}),_N_E=e.O()}]);